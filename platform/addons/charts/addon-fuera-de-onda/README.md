# Fuera de Onda Helm Chart

A simple Helm chart that creates a Kubernetes Job which generates a ConfigMap with a funny message.

> **Note:** This Helm chart was 100% generated by Amazon Q.

## Overview

This chart deploys a one-time job that creates a ConfigMap in the specified namespace. The ConfigMap contains a customizable funny message and annotations, including an ArgoCD tracking ID.

## Prerequisites

- Kubernetes 1.16+
- Helm 3.0+

## Installing the Chart

To install the chart with the release name `my-release`:

```bash
helm install my-release ./fuera-de-onda
```

## Uninstalling the Chart

To uninstall/delete the `my-release` deployment:

```bash
helm delete my-release
```

## Configuration

The following table lists the configurable parameters of the chart and their default values.

| Parameter | Description | Default |
|-----------|-------------|---------|
| `configMapName` | Name of the ConfigMap to be created | `"funny-configmap"` |
| `namespace` | Namespace where the ConfigMap will be created (defaults to release namespace) | `""` |
| `funnyMessage` | Funny message to be included in the ConfigMap | `"Why don't scientists trust atoms? Because they make up everything!"` |
| `annotations` | Annotations to be added to the ConfigMap | See below |
| `job.serviceAccount.create` | Whether to create a service account | `true` |
| `job.serviceAccount.name` | Name of the service account to use | `""` (defaults to release name) |
| `job.image.repository` | Image repository for the job | `"bitnami/kubectl"` |
| `job.image.tag` | Image tag for the job | `"latest"` |
| `job.image.pullPolicy` | Image pull policy | `"IfNotPresent"` |
| `job.resources` | Resource requests and limits for the job | See below |

### Default Annotations

```yaml
annotations:
  argocd.argoproj.io/tracking-id: "argocdappname:/ConfigMap:{{ .Release.Namespace }}/{{ .Values.configMapName }}"
  created-by: "fuera-de-onda-helm-chart"
  purpose: "Just for fun"
```

### Default Resources

```yaml
resources:
  limits:
    cpu: 100m
    memory: 128Mi
  requests:
    cpu: 50m
    memory: 64Mi
```

## Example: Custom Values

Create a `values.yaml` file with your custom configuration:

```yaml
configMapName: my-custom-configmap
funnyMessage: "I told my wife she was drawing her eyebrows too high. She looked surprised."
annotations:
  argocd.argoproj.io/tracking-id: "argocdappname:/ConfigMap:{{ .Release.Namespace }}/{{ .Values.configMapName }}"
  created-by: "custom-deployment"
  team: "humor-department"
```

Then install the chart with:

```bash
helm install my-release ./fuera-de-onda -f values.yaml
```

## How It Works

1. The chart creates a ServiceAccount, Role, and RoleBinding to grant permissions for ConfigMap creation
2. A Job is deployed that runs a kubectl container
3. The Job creates a ConfigMap with the specified name, message, and annotations
4. Once the ConfigMap is created, the Job completes

## Notes

- The Job has a backoff limit of 3 attempts
- The ConfigMap will be created in the same namespace as the release unless specified otherwise
- The ArgoCD tracking ID annotation is templated to include the namespace and ConfigMap name
